<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>IVAO subsystem | Pilots</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
 <script src="https://unpkg.com/jquery@3.6.0/dist/jquery.min.js" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" crossorigin="anonymous"></script>
  </head>
  <body>
    <table class="table table-dark table-hover table-bordered border-light">
      <thead>
        <tr>
          <th scope="col">Callsign</th>
          <th scope="col">Aircraft Type</th>
          <th scope="col">Departure</th>
          <th scope="col">Arrival</th>
          <th scope="col">Transponder</th>
          <th scope="col">Route</th>
          <th scope="col">Remarks</th>
          <th scope="col">State</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>




    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
  <script>
    $.getJSON('https://api.ivao.aero/v2/tracker/whazzup', function (data) {
        var clients = data.clients;
        var pilots = data.clients.pilots;
        for (var i = 0; i < pilots.length; i++) {
          var pilot = pilots[i];
          var callsign = pilot.callsign;
          var fpl = pilot.flightPlan;
          var aircraftType = fpl.aircraft.icaoCode;
          var route = fpl.route;
          var remarks = fpl.remarks;
          var departure = fpl.departureId;
          var arrival = fpl.arrivalId;
          var state = pilot.lastTrack.state;
          var sqk = pilot.lastTrack.transponder;
          if (state == "On Blocks" || state == "Landed") {
            var row = $('<tr class="table-success">');
          }
          else if(state == "En Route" || state == "Departing"){
            var row = $('<tr class="table-warning">');
          }
          else if(state == "Approach"){
            var row = $('<tr class="table-info">');
          }
          else if(state == "Initial Climb"){
            var row = $('<tr class="table-danger">');
          }          
          else {
            var row = $('<tr class="table-secondary">');
          }
          row.append($('<td>').text(callsign));
          row.append($('<td>').text(aircraftType));
          row.append($('<td>').text(departure));
          row.append($('<td>').text(arrival));
          row.append($('<td>').text(sqk));
          row.append($('<td>').text(route));
          row.append($('<td>').text(remarks));
          row.append($('<td>').text(state));
          $('tbody').append(row);

        }
      }
    );
    //auto refresh every 1 minute
    setTimeout(function () {
        location.reload();
    }, 30000);
    

  </script>


</body></html>